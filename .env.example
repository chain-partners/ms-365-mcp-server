# Microsoft 365 MCP Server Configuration
# ========================================
# OAuth credentials (client_id, client_secret) are passed via MCP client request.
# All environment variables below are OPTIONAL - server works without any config.

# -------------------------------------------------------------------
# Docker Compose
# -------------------------------------------------------------------
MS365_MCP_PORT=3000

# -------------------------------------------------------------------
# Server Mode & Tool Selection (Important)
# -------------------------------------------------------------------

# Organization mode - enables Teams, SharePoint, organizational tools
# Required for: work, users presets
# MS365_MCP_ORG_MODE=true

# Tool filter - regex pattern to match tool names
# Examples:
#   mail               - mail tools only
#   mail|calendar      - mail and calendar
#   mail|calendar|file - mail, calendar, file tools
#   .*                 - all tools (default)
#
# Preset patterns (use via CLI --preset option):
#   mail     = mail|attachment|draft
#   calendar = calendar|event
#   files    = drive|file|upload|download|folder|item
#   contacts = contact
#   tasks    = todo|planner|task
#   excel    = excel|worksheet|workbook|range|chart
#   onenote  = onenote|notebook|section|page
#   search   = search|query
#   personal = mail|calendar|drive|contact|todo|onenote|...
#   work     = team|channel|chat|sharepoint|planner|... (requires ORG_MODE)
#   users    = user|list-users (requires ORG_MODE)
#   all      = .* (everything)
#
# ENABLED_TOOLS=mail|calendar|files

# Read-only mode - disables all write/delete operations
# READ_ONLY=false

# -------------------------------------------------------------------
# Basic Settings
# -------------------------------------------------------------------

# Tenant ID (default: common - allows any Microsoft account)
# MS365_MCP_TENANT_ID=common

# CORS origin (default: * - allow all)
# MS365_MCP_CORS_ORIGIN=*

# -------------------------------------------------------------------
# Advanced (Rarely needed)
# -------------------------------------------------------------------

# Cloud type: global (default) or china (21Vianet)
# MS365_MCP_CLOUD_TYPE=global

# Log level: debug, info, warn, error
# LOG_LEVEL=info

# Output format: json (default) or toon (experimental)
# MS365_MCP_OUTPUT_FORMAT=json

# Azure Key Vault URL (for enterprise secret management)
# MS365_MCP_KEYVAULT_URL=https://your-vault.vault.azure.net

# CLI-only: Client ID for device code login (--login flag)
# MS365_MCP_CLIENT_ID=your-public-client-id
